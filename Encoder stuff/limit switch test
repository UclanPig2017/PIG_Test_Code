// luke code for limit switches
#include "stm32f4xx_hal.h"
#include "stm32f4xx_hal_rcc.h"
#include "stm32f4xx_hal_gpio.h"

/*Function Prototypes*/
void GPIO_Configure(void);

//Configure Pins
void GPIO_Configure(void)
{
  /******GPIO PINB2******/
  GPIO_InitTypeDef GPIO_InitStructure;
  __HAL_RCC_GPIOA_CLK_ENABLE();
  
  GPIO_InitStructure.Pin = GPIO_PIN_2; 
	GPIO_InitStructure.Mode = GPIO_MODE_INPUT;
	GPIO_InitStructure.Speed = GPIO_SPEED_FREQ_HIGH; 
	GPIO_InitStructure.Pull = GPIO_PULLUP;    
	HAL_GPIO_Init(GPIOA, &GPIO_InitStructure);
	
	/* Enable and set EXTI Line2 Interrupt to the lowest priority */
  HAL_NVIC_SetPriority(EXTI2_IRQn, 2, 0);
  HAL_NVIC_EnableIRQ(EXTI2_IRQn);
	
	/******LED Pin******/
	//Enable GPIOA
	__HAL_RCC_GPIOA_CLK_ENABLE();
	
	//Initialise Pin	
	GPIO_InitStructure.Pin = GPIO_PIN_5; 
	GPIO_InitStructure.Mode = GPIO_MODE_OUTPUT_PP; 
	GPIO_InitStructure.Speed = GPIO_SPEED_FREQ_HIGH; 
	HAL_GPIO_Init(GPIOA, &GPIO_InitStructure);
}

int main(void)
{
	GPIO_Configure();
  while(1)
  {
		;
  }
}

void EXTI2_IRQHandler(void)
{
  HAL_GPIO_TogglePin(GPIOA, GPIO_PIN_5);
}
